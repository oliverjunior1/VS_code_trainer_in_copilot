const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const gravity = 0.5;
let keys = {};

let player = {
  x: 50,
  y: 300,
  width: 40,
  height: 40,
  color: "blue",
  velocityY: 0,
  grounded: false
};

let ground = {
  x: 0,
  y: 350,
  width: canvas.width,
  height: 50,
  color: "#654321"
};

let enemies = [
  { x: 600, y: 310, width: 30, height: 40, color: "red", direction: -1 }
];

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

function update() {
  // Movimento horizontal
  if (keys["a"]) player.x -= 5;
  if (keys["d"]) player.x += 5;

  // Pulo
  if (keys[" "] && player.grounded) {
    player.velocityY = -10;
    player.grounded = false;
  }

  // Gravidade
  player.velocityY += gravity;
  player.y += player.velocityY;

  // Colisão com o chão
  if (player.y + player.height >= ground.y) {
    player.y = ground.y - player.height;
    player.velocityY = 0;
    player.grounded = true;
  }

  // Movimento dos inimigos
  enemies.forEach(enemy => {
    enemy.x += enemy.direction * 2;
    if (enemy.x < 0 || enemy.x + enemy.width > canvas.width) {
      enemy.direction *= -1;
    }
  });
}

function drawRect(obj) {
  ctx.fillStyle = obj.color;
  ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawRect(ground);
  drawRect(player);
  enemies.forEach(drawRect);
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

gameLoop();